# docker-compose.dev.yml - Development configuration with hot reloading
# Usage: docker compose -f docker-compose.yml -f docker-compose.dev.yml up
services:
  # Main Reasoning Agent API - Development overrides
  reasoning-api:
    volumes:
      - ./api:/app/api
      - ./tests:/app/tests
      - ./config:/app/config:ro
      - ./prompts:/app/prompts:ro
    environment:
      # Development-specific settings
      # ENV: Environment designation (development/production)
      - ENV=development
      # LOG_LEVEL: Logging level for development (DEBUG, INFO, WARNING, ERROR)
      - LOG_LEVEL=DEBUG
      
      # Authentication Configuration (Development)
      # REQUIRE_AUTH: Disable auth for easier development testing
      - REQUIRE_AUTH=false  # Disable auth for easier dev testing
      # API_TOKENS: Development tokens (commented out when auth disabled)
      # - API_TOKENS=dev-token,test-token

      # HTTP Client Configuration (Development)
      # HTTP_READ_TIMEOUT: Increased timeout for streaming responses in development
      - HTTP_READ_TIMEOUT=60.0  # Increase timeout for streaming
      
      # MCP Configuration (Development)
      # MCP_CONFIG_PATH: Use default config (inherits from docker-compose.yml)
      # - MCP_CONFIG_PATH=config/mcp_servers.json  # Override if needed
      
      # Tracing Configuration (Development)
      # ENABLE_CONSOLE_TRACING: Output traces to console for debugging
      - ENABLE_CONSOLE_TRACING=false
    # Enable hot reloading by overriding the command
    command: ["uv", "run", "uvicorn", "api.main:app", "--host", "0.0.0.0", "--port", "8000", "--reload"]

  # Tools API - Development overrides
  tools-api:
    volumes:
      # Mount source code for hot reloading
      - ./tools_api:/app/tools_api
    environment:
      # Development-specific settings
      - ENV=development
      - LOG_LEVEL=DEBUG
    # Enable hot reloading
    command: ["uv", "run", "uvicorn", "tools_api.main:app", "--host", "0.0.0.0", "--port", "8001", "--reload"]
